<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice-Enabled Network Management Platform</title>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* NOC Style Base */
        body { 
            margin: 0; 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #fff;
        }
        
        /* Sidebar Panel */
        #control-panel { 
            width: 280px; 
            background: #2d2d2d; 
            padding: 15px; 
            overflow-y: auto;
            border-right: 2px solid #404040;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
        }
        
        #control-panel h3 {
            margin: 0 0 20px 0;
            color: #4caf50;
            font-size: 18px;
            text-align: center;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 10px;
        }
        
        #control-panel h4 { 
            margin: 20px 0 8px 0; 
            color: #ccc; 
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        #control-panel hr { 
            margin: 15px 0; 
            border: none; 
            border-top: 1px solid #404040; 
        }
        
        /* Navigation Buttons */
        .nav-item { 
            padding: 12px 15px; 
            margin: 6px 0; 
            background: #404040; 
            border: 1px solid #555; 
            cursor: pointer; 
            border-radius: 6px; 
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-item:hover { 
            background: #4caf50; 
            transform: translateX(5px);
        }
        
        .nav-item.active {
            background: #4caf50;
            border-color: #66bb6a;
        }
        
        .nav-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Control Buttons */
        .control-btn {
            width: 100%; 
            margin: 4px 0; 
            padding: 10px;
            background: #555;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        
        .control-btn:hover {
            background: #666;
        }
        
        .control-btn.danger {
            background: #f44336;
        }
        
        .control-btn.danger:hover {
            background: #d32f2f;
        }
        
        .control-btn.primary {
            background: #2196f3;
        }
        
        .control-btn.primary:hover {
            background: #1976d2;
        }
        
        /* Main Content Area */
        #main-content { 
            flex: 1; 
            position: relative; 
            background: #1a1a1a;
        }
        
        /* Content Sections */
        .content-section {
            display: none;
            padding: 20px;
            height: calc(100vh - 40px);
            overflow-y: auto;
        }
        
        .content-section.active {
            display: block;
        }
        
        /* Header Controls */
        #header-controls { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            display: flex; 
            gap: 10px;
            z-index: 1000;
        }
        
        .header-btn {
            padding: 10px 15px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn:hover {
            background: rgba(76, 175, 80, 1);
        }
        
        /* Status Display */
        #status-display { 
            position: absolute; 
            bottom: 15px; 
            left: 15px; 
            background: rgba(45, 45, 45, 0.95); 
            padding: 15px; 
            max-width: 400px; 
            border-radius: 8px;
            border: 1px solid #404040;
        }
        
        .status-chip { 
            display: inline-block; 
            padding: 6px 12px; 
            margin-right: 6px; 
            margin-bottom: 4px;
            border-radius: 20px; 
            background: #555; 
            cursor: pointer;
            transition: background 0.3s;
            font-size: 12px;
        }
        
        .status-chip.connected { background: #4caf50; }
        .status-chip.disconnected { background: #f44336; }
        .status-chip.warning { background: #ff9800; }
        
        /* Voice Interface */
        #voice-container { 
            position: absolute; 
            bottom: 15px; 
            right: 15px; 
            background: rgba(45, 45, 45, 0.95);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #404040;
        }
        
        .voice-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .voice-btn {
            padding: 10px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .voice-toggle { background: #666; color: white; }
        .voice-toggle.enabled { background: #4caf50; }
        .voice-listen { background: #2196f3; color: white; }
        .voice-listen.listening { background: #ff5722; animation: pulse 1.5s infinite; }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Cards and Grids */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .dashboard-card {
            background: #2d2d2d;
            border: 1px solid #404040;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.3s;
        }
        
        .dashboard-card:hover {
            transform: translateY(-2px);
            border-color: #4caf50;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #4caf50;
        }
        
        .card-header h3 {
            margin: 0;
            font-size: 18px;
        }
        
        .card-content {
            color: #ccc;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #404040;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #4caf50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #ccc;
            font-size: 14px;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            background: #404040;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #4caf50;
        }
        
        /* Loading Animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .loading-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #404040;
            border-top: 3px solid #4caf50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: white;
            margin-top: 15px;
            text-align: center;
        }
        
        /* Toast Notifications */
        #toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
        }
        
        .toast {
            background: #4caf50;
            color: white;
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 300px;
            transform: translateX(400px);
            animation: slideIn 0.3s ease forwards;
        }
        
        .toast.error { background: #f44336; }
        .toast.warning { background: #ff9800; }
        .toast.info { background: #2196f3; }
        
        /* LTM Status Panel Styles */
        .ltm-status-panel {
            background: #2a2a2a;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #444;
            max-width: 800px;
            margin: 20px auto;
        }
        
        .ltm-status-panel h3 {
            color: #4caf50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .ltm-status-panel h4 {
            color: #fff;
            margin: 20px 0 10px 0;
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        
        .ltm-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .ltm-capabilities {
            list-style: none;
            padding: 0;
        }
        
        .ltm-capabilities li {
            background: #1a1a1a;
            padding: 8px 15px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 3px solid #4caf50;
        }
        
        .ltm-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .ltm-stats > div {
            background: #1a1a1a;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            border: 1px solid #333;
        }
        
        .ltm-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        @keyframes slideIn {
            to { transform: translateX(0); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            body { flex-direction: column; }
            #control-panel { width: 100%; height: 200px; padding: 10px; }
            #main-content { flex: 1; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .dashboard-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Control Panel Sidebar -->
    <div id="control-panel">
        <h3><i class="fas fa-network-wired"></i> Network NOC</h3>
        
        <h4><i class="fas fa-tachometer-alt"></i> Navigation</h4>
        <div class="nav-item active" onclick="showSection('overview')">
            <i class="fas fa-home"></i>
            <span>Overview Dashboard</span>
        </div>
        <div class="nav-item" onclick="showSection('investigation')">
            <i class="fas fa-search"></i>
            <span>Store Investigation</span>
        </div>
        <div class="nav-item" onclick="showSection('brand-BWW')">
            <i class="fas fa-utensils"></i>
            <span>Buffalo Wild Wings</span>
        </div>
        <div class="nav-item" onclick="showSection('brand-ARBYS')">
            <i class="fas fa-hamburger"></i>
            <span>Arby's</span>
        </div>
        <div class="nav-item" onclick="showSection('brand-SONIC')">
            <i class="fas fa-car"></i>
            <span>Sonic Drive-In</span>
        </div>
        
        <hr>
        <h4><i class="fas fa-tools"></i> Management Tools</h4>
        <div class="nav-item" onclick="showSection('fortimanager')">
            <i class="fas fa-shield-alt"></i>
            <span>FortiManager</span>
        </div>
        <div class="nav-item" onclick="showSection('fortianalyzer')">
            <i class="fas fa-chart-line"></i>
            <span>FortiAnalyzer</span>
        </div>
        <div class="nav-item" onclick="showSection('webfilters')">
            <i class="fas fa-filter"></i>
            <span>Web Filters</span>
        </div>
        
        <hr>
        <h4><i class="fas fa-brain"></i> AI Controls</h4>
        <button class="control-btn primary" onclick="toggleLTMSystem()">
            <i class="fas fa-robot"></i>
            LTM Intelligence
        </button>
        <button class="control-btn" onclick="refreshData()">
            <i class="fas fa-sync-alt"></i>
            Refresh Data
        </button>
        <button class="control-btn" onclick="exportTopology()">
            <i class="fas fa-download"></i>
            Export Topology
        </button>
        
        <hr>
        <h4><i class="fas fa-microphone"></i> Voice Control</h4>
        <div style="text-align: center; margin: 10px 0;">
            <button class="control-btn primary" id="voiceToggle" onclick="toggleVoice()">
                <i class="fas fa-microphone"></i>
                Enable Voice
            </button>
        </div>
        
        <hr>
        <button class="control-btn danger" onclick="if(confirm('Clear all data?')) clearAll()">
            <i class="fas fa-trash"></i>
            Emergency Reset
        </button>
    </div>

    <!-- Main Content Area -->
    <div id="main-content">
        <!-- Header Controls -->
        <div id="header-controls">
            <button class="header-btn" onclick="generateReport()">
                <i class="fas fa-file-pdf"></i>
                Generate Report
            </button>
            <button class="header-btn" onclick="showSettings()">
                <i class="fas fa-cog"></i>
                Settings
            </button>
        </div>

        <!-- Overview Section -->
        <div id="overview" class="content-section active">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-tachometer-alt"></i> Network Operations Dashboard
            </h2>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalStores">-</div>
                    <div class="stat-label">Total Stores</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="securityEvents">-</div>
                    <div class="stat-label">Security Events</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="blockedUrls">-</div>
                    <div class="stat-label">Blocked URLs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="healthyDevices">-</div>
                    <div class="stat-label">Healthy Devices</div>
                </div>
            </div>
            
            <!-- Dashboard Grid -->
            <div class="dashboard-grid" id="brandsGrid">
                <!-- Brand cards will be populated by JavaScript -->
            </div>
        </div>

        <!-- Investigation Section -->
        <div id="investigation" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-search"></i> Store Investigation
            </h2>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <i class="fas fa-store"></i>
                    <h3>Store Analysis</h3>
                </div>
                <div class="card-content">
                    <div class="form-group">
                        <label for="investigationBrand">Select Brand:</label>
                        <select id="investigationBrand" class="form-control">
                            <option value="">Choose a brand...</option>
                            <option value="BWW">Buffalo Wild Wings</option>
                            <option value="ARBYS">Arby's</option>
                            <option value="SONIC">Sonic Drive-In</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="investigationStore">Store ID:</label>
                        <input type="text" id="investigationStore" class="form-control" placeholder="e.g., 155">
                    </div>
                    <div class="form-group">
                        <label for="investigationPeriod">Time Period:</label>
                        <select id="investigationPeriod" class="form-control">
                            <option value="1h">Last Hour</option>
                            <option value="24h" selected>Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                        </select>
                    </div>
                    <button class="control-btn primary" onclick="runInvestigation()">
                        <i class="fas fa-play"></i>
                        Start Investigation
                    </button>
                </div>
            </div>
        </div>

        <!-- Brand Sections (will be populated by JavaScript) -->
        <div id="brand-BWW" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-utensils"></i> Buffalo Wild Wings Network
            </h2>
            <div id="brand-BWW-content">Loading...</div>
        </div>

        <div id="brand-ARBYS" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-hamburger"></i> Arby's Network
            </h2>
            <div id="brand-ARBYS-content">Loading...</div>
        </div>

        <div id="brand-SONIC" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-car"></i> Sonic Drive-In Network
            </h2>
            <div id="brand-SONIC-content">Loading...</div>
        </div>

        <!-- FortiManager Section -->
        <div id="fortimanager" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-shield-alt"></i> FortiManager Management
            </h2>
            <div id="fortimanagerContent">
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <i class="fas fa-server"></i>
                            <h3>FortiManager Instances</h3>
                        </div>
                        <div class="card-content">
                            <p>Centralized management and configuration of FortiGate devices across all restaurant brands.</p>
                            <button class="control-btn primary" onclick="loadFortiManagerData()">
                                <i class="fas fa-sync-alt"></i>
                                Load FortiManager Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FortiAnalyzer Section -->
        <div id="fortianalyzer" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-chart-line"></i> FortiAnalyzer Intelligence
            </h2>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-database"></i>
                        <h3>Log Analysis</h3>
                    </div>
                    <div class="card-content">
                        <p>Security log analysis and threat intelligence from FortiAnalyzer instances.</p>
                        <div class="form-group">
                            <label>Select Brand:</label>
                            <select class="form-control" id="faz-brand">
                                <option value="BWW">Buffalo Wild Wings</option>
                                <option value="ARBYS">Arby's</option>
                                <option value="SONIC">Sonic Drive-In</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Timeframe:</label>
                            <select class="form-control" id="faz-timeframe">
                                <option value="1h">Last Hour</option>
                                <option value="24h" selected>Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                            </select>
                        </div>
                        <button class="control-btn primary" onclick="loadFortiAnalyzerLogs()">
                            <i class="fas fa-search"></i>
                            Analyze Security Logs
                        </button>
                        <button class="control-btn" onclick="loadThreatIntelligence()">
                            <i class="fas fa-shield-alt"></i>
                            Threat Intelligence
                        </button>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Security Alerts</h3>
                    </div>
                    <div class="card-content" id="security-alerts">
                        <p>FortiAnalyzer integration requires configuration for detailed security analysis.</p>
                        <div class="status-chip warning">Configuration Required</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Web Filters Section -->
        <div id="webfilters" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-filter"></i> Web Filters Management
            </h2>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-globe"></i>
                        <h3>Filtering Status</h3>
                    </div>
                    <div class="card-content">
                        <div id="web-filter-status">
                            <p>Web content filtering and SSL inspection management.</p>
                            <button class="control-btn primary" onclick="checkWebFiltersStatus()">
                                <i class="fas fa-sync-alt"></i>
                                Check Status
                            </button>
                            <button class="control-btn" onclick="loadFilterPolicies()">
                                <i class="fas fa-list"></i>
                                View Policies
                            </button>
                        </div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-ban"></i>
                        <h3>Store Filtering</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>Brand:</label>
                            <select class="form-control" id="wf-brand">
                                <option value="BWW">Buffalo Wild Wings</option>
                                <option value="ARBYS">Arby's</option>
                                <option value="SONIC">Sonic Drive-In</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Store ID:</label>
                            <input type="text" class="form-control" id="wf-store" placeholder="e.g., 155">
                        </div>
                        <button class="control-btn primary" onclick="analyzeStoreFiltering()">
                            <i class="fas fa-search"></i>
                            Analyze Store Filtering
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="content-section">
            <h2 style="color: #4caf50; margin-bottom: 30px;">
                <i class="fas fa-cog"></i> System Settings
            </h2>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-microphone"></i>
                        <h3>Voice Settings</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>Speech Rate:</label>
                            <input type="range" class="form-control" id="settings-speech-rate" min="0.5" max="2" step="0.1" value="0.9">
                            <span id="speech-rate-value">0.9x</span>
                        </div>
                        <div class="form-group">
                            <label>Speech Volume:</label>
                            <input type="range" class="form-control" id="settings-speech-volume" min="0.1" max="1" step="0.1" value="0.8">
                            <span id="speech-volume-value">80%</span>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="settings-auto-announce" checked>
                                Auto Announcements
                            </label>
                        </div>
                        <button class="control-btn primary" onclick="saveVoiceSettings()">
                            <i class="fas fa-save"></i>
                            Save Voice Settings
                        </button>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-display"></i>
                        <h3>Display Settings</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="settings-dark-theme" checked>
                                Dark Theme (NOC Mode)
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="settings-show-tooltips" checked>
                                Show Tooltips
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Refresh Interval:</label>
                            <select class="form-control" id="settings-refresh-interval">
                                <option value="30">30 seconds</option>
                                <option value="60" selected>1 minute</option>
                                <option value="300">5 minutes</option>
                                <option value="0">Manual only</option>
                            </select>
                        </div>
                        <button class="control-btn primary" onclick="saveDisplaySettings()">
                            <i class="fas fa-save"></i>
                            Save Display Settings
                        </button>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Security Settings</h3>
                    </div>
                    <div class="card-content">
                        <p><strong>Session Timeout:</strong> 8 hours</p>
                        <p><strong>Auto-Lock:</strong> 30 minutes inactive</p>
                        <p><strong>Audit Logging:</strong> Enabled</p>
                        <p><strong>Encryption:</strong> TLS 1.3</p>
                        <button class="control-btn" onclick="viewSecurityLog()">
                            <i class="fas fa-eye"></i>
                            View Security Log
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Display -->
        <div id="status-display">
            <strong>System Status</strong><br>
            <div id="connectionStatus" class="status-chip disconnected">
                <i class="fas fa-circle"></i>
                <span>Checking...</span>
            </div>
        </div>

        <!-- Voice Interface -->
        <div id="voice-container">
            <div class="voice-controls">
                <button id="voiceToggleMain" class="voice-btn voice-toggle" title="Toggle Voice Interface">
                    <i class="fas fa-microphone"></i>
                </button>
                <button id="voiceListen" class="voice-btn voice-listen" title="Start Voice Command" disabled>
                    <i class="fas fa-microphone-alt"></i>
                </button>
                <button id="voiceHelp" class="voice-btn" style="background: #666;" title="Voice Help">
                    <i class="fas fa-question-circle"></i>
                </button>
            </div>
            <div id="voiceStatus" style="text-align: center; font-size: 12px; color: #ccc;">
                Voice Disabled
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <div class="loading-text">Processing...</div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- JavaScript -->
    <script src="/static/js/dashboard.js"></script>
    <script src="/static/js/voice-interface.js"></script>
    <script src="/static/js/voice-accessibility.js"></script>
    <script src="/static/js/voice-commands.js"></script>
    
    <script>
        // NOC-Style Navigation
        function showSection(sectionId) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                currentSection = sectionId;
                
                // Update active nav item
                event?.target?.closest('.nav-item')?.classList.add('active');
                
                // Load section-specific data
                if (typeof loadSectionData === 'function') {
                    loadSectionData(sectionId);
                }
            }
        }
        
        // Voice control integration
        function toggleVoice() {
            if (typeof voiceInterface !== 'undefined') {
                voiceInterface.toggleVoice();
                const btn = document.getElementById('voiceToggle');
                const btnMain = document.getElementById('voiceToggleMain');
                
                if (voiceInterface.isEnabled) {
                    btn.innerHTML = '<i class="fas fa-microphone"></i> Disable Voice';
                    btnMain.classList.add('enabled');
                } else {
                    btn.innerHTML = '<i class="fas fa-microphone"></i> Enable Voice';
                    btnMain.classList.remove('enabled');
                }
            }
        }
        
        // System controls
        async function toggleLTMSystem() {
            showLoading(true, 'Checking LTM Intelligence System...');
            
            try {
                const response = await apiCall('/api/ltm/status');
                if (response.success) {
                    // Show LTM status modal or panel
                    showLTMStatus(response);
                } else {
                    showToast('LTM system not available', 'error');
                }
            } catch (error) {
                showToast('Failed to connect to LTM system', 'error');
            }
            
            showLoading(false);
        }
        
        function showLTMStatus(ltmData) {
            const statusHTML = `
                <div class="ltm-status-panel">
                    <h3><i class="fas fa-brain"></i> LTM Intelligence System Status</h3>
                    <div class="status-chip connected">System: ${ltmData.ltm_status}</div>
                    
                    <h4>Components Status:</h4>
                    <div class="ltm-components">
                        ${Object.entries(ltmData.components).map(([component, status]) => 
                            `<div class="status-chip ${status === 'active' ? 'connected' : 'warning'}">${component}: ${status}</div>`
                        ).join('')}
                    </div>
                    
                    <h4>Capabilities:</h4>
                    <ul class="ltm-capabilities">
                        ${ltmData.capabilities.map(cap => `<li>${cap}</li>`).join('')}
                    </ul>
                    
                    <h4>Statistics:</h4>
                    <div class="ltm-stats">
                        <div>Total Events: ${ltmData.statistics.total_events}</div>
                        <div>Patterns Detected: ${ltmData.statistics.total_patterns}</div>
                        <div>Voice Interactions: ${ltmData.statistics.total_voice_interactions}</div>
                        <div>Pattern Confidence: ${(ltmData.statistics.avg_pattern_confidence * 100).toFixed(1)}%</div>
                        <div>Voice Success Rate: ${(ltmData.statistics.voice_success_rate * 100).toFixed(1)}%</div>
                    </div>
                    
                    <div class="ltm-actions">
                        <button onclick="analyzeLTMPatterns()" class="control-btn">Analyze Patterns</button>
                        <button onclick="generateLTMPredictions()" class="control-btn">Generate Predictions</button>
                        <button onclick="getLTMInsights()" class="control-btn primary">Get AI Insights</button>
                    </div>
                </div>
            `;
            
            // Show in main content area temporarily
            const mainContent = document.querySelector('.main-content');
            const originalContent = mainContent.innerHTML;
            mainContent.innerHTML = statusHTML;
            
            // Add close functionality
            setTimeout(() => {
                const panel = document.querySelector('.ltm-status-panel');
                if (panel) {
                    panel.innerHTML += '<button onclick="location.reload()" class="control-btn" style="margin-top: 20px;">Close</button>';
                }
            }, 100);
        }
        
        async function analyzeLTMPatterns() {
            showLoading(true, 'Analyzing network patterns...');
            
            try {
                const response = await apiCall('/api/ltm/patterns/analyze?time_window_hours=24');
                if (response.success) {
                    showToast(`Found ${response.patterns_detected} patterns`, 'success');
                    if (response.patterns_detected > 0) {
                        showToast(`${response.summary.high_confidence_patterns} high confidence patterns detected`, 'info');
                    }
                } else {
                    showToast('Pattern analysis failed', 'error');
                }
            } catch (error) {
                showToast('Failed to analyze patterns', 'error');
            }
            
            showLoading(false);
        }
        
        async function generateLTMPredictions() {
            showLoading(true, 'Generating AI predictions...');
            
            try {
                const response = await apiCall('/api/ltm/predictions/generate?time_horizon_days=7');
                if (response.success) {
                    showToast(`Generated ${response.predictions_generated} predictions`, 'success');
                    if (response.summary.critical_predictions > 0) {
                        showToast(`âš ï¸ ${response.summary.critical_predictions} critical predictions found`, 'warning');
                    }
                } else {
                    showToast('Prediction generation failed', 'error');
                }
            } catch (error) {
                showToast('Failed to generate predictions', 'error');
            }
            
            showLoading(false);
        }
        
        async function getLTMInsights() {
            showLoading(true, 'Gathering AI insights...');
            
            try {
                const response = await apiCall('/api/ltm/analytics/insights');
                if (response.success) {
                    showToast('AI insights generated successfully', 'success');
                    const insights = response.ltm_analytics;
                    if (insights.recent_activity.patterns_detected_24h > 0) {
                        showToast(`ðŸ“Š ${insights.recent_activity.patterns_detected_24h} patterns detected in 24h`, 'info');
                    }
                } else {
                    showToast('Failed to generate insights', 'error');
                }
            } catch (error) {
                showToast('Failed to get AI insights', 'error');
            }
            
            showLoading(false);
        }
        
        function refreshData() {
            if (typeof refreshCurrentSection === 'function') {
                refreshCurrentSection();
            }
            showToast('Refreshing data...', 'info');
        }
        
        function exportTopology() {
            const data = {
                timestamp: new Date().toISOString(),
                networks: ['BWW', 'ARBYS', 'SONIC'],
                topology: 'Network topology data would be exported here'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `network-topology-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Network topology exported successfully', 'success');
        }
        
        function generateReport() {
            showLoading(true, 'Generating comprehensive network report...');
            
            // Simulate report generation
            setTimeout(() => {
                const reportData = {
                    generated: new Date().toISOString(),
                    summary: 'Network health report',
                    brands: ['BWW', 'ARBYS', 'SONIC'],
                    total_devices: document.getElementById('totalStores').textContent,
                    healthy_devices: document.getElementById('healthyDevices').textContent
                };
                
                const blob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `network-report-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showLoading(false);
                showToast('Network report generated and downloaded', 'success');
            }, 2000);
        }
        
        function showSettings() {
            showSection('settings');
        }
        
        function clearAll() {
            showToast('System reset initiated', 'warning');
        }
        
        // Enhanced toast function for NOC style
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const iconMap = {
                success: 'fas fa-check-circle',
                warning: 'fas fa-exclamation-triangle',
                error: 'fas fa-times-circle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <i class="${iconMap[type]}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (container.contains(toast)) {
                    toast.style.animation = 'slideIn 0.3s ease reverse';
                    setTimeout(() => container.removeChild(toast), 300);
                }
            }, 5000);
        }
        
        // Initialize the interface
        document.addEventListener('DOMContentLoaded', function() {
            // Set up voice controls
            const voiceToggleMain = document.getElementById('voiceToggleMain');
            const voiceListen = document.getElementById('voiceListen');
            const voiceHelp = document.getElementById('voiceHelp');
            
            if (voiceToggleMain) {
                voiceToggleMain.addEventListener('click', toggleVoice);
            }
            
            if (voiceListen && typeof voiceInterface !== 'undefined') {
                voiceListen.addEventListener('click', () => {
                    voiceInterface.startListening();
                });
            }
            
            if (voiceHelp && typeof voiceInterface !== 'undefined') {
                voiceHelp.addEventListener('click', () => {
                    voiceInterface.announceVoiceHelp();
                });
            }
            
            // Welcome message
            setTimeout(() => {
                showToast('Voice-Enabled Network Management Platform ready!', 'success');
            }, 1000);
        });
        
        // FortiAnalyzer Functions
        async function loadFortiAnalyzerLogs() {
            const brand = document.getElementById('faz-brand').value;
            const timeframe = document.getElementById('faz-timeframe').value;
            
            showLoading(true, 'Loading FortiAnalyzer logs...');
            
            try {
                const response = await apiCall(`/api/fortianalyzer/logs/${brand}/155?timeframe=${timeframe}`);
                const alertsDiv = document.getElementById('security-alerts');
                
                if (response.success) {
                    alertsDiv.innerHTML = `
                        <p>FortiAnalyzer logs loaded for ${brand}</p>
                        <div class="status-chip connected">Logs Available</div>
                        <p>Timeframe: ${timeframe}</p>
                    `;
                } else {
                    alertsDiv.innerHTML = `
                        <p>FortiAnalyzer: ${response.error || 'Configuration required'}</p>
                        <div class="status-chip warning">Configuration Required</div>
                    `;
                }
            } catch (error) {
                showToast('Failed to load FortiAnalyzer logs', 'error');
            }
            
            showLoading(false);
        }
        
        async function loadThreatIntelligence() {
            const brand = document.getElementById('faz-brand').value;
            
            showLoading(true, 'Loading threat intelligence...');
            
            try {
                const response = await apiCall(`/api/fortianalyzer/threats/${brand}`);
                if (response.success) {
                    showToast(`Threat intelligence loaded for ${brand}`, 'success');
                } else {
                    showToast(response.error || 'Failed to load threat intelligence', 'error');
                }
            } catch (error) {
                showToast('Failed to load threat intelligence', 'error');
            }
            
            showLoading(false);
        }
        
        // Web Filters Functions
        async function checkWebFiltersStatus() {
            showLoading(true, 'Checking web filters status...');
            
            try {
                const response = await apiCall('/api/webfilters/status');
                const statusDiv = document.getElementById('web-filter-status');
                
                if (response.success) {
                    statusDiv.innerHTML += `
                        <div class="status-chip connected" style="display: block; margin-top: 10px;">
                            Web Filters: Active
                        </div>
                    `;
                } else {
                    statusDiv.innerHTML += `
                        <div class="status-chip warning" style="display: block; margin-top: 10px;">
                            ${response.error || 'Configuration required'}
                        </div>
                    `;
                }
            } catch (error) {
                showToast('Failed to check web filters status', 'error');
            }
            
            showLoading(false);
        }
        
        async function loadFilterPolicies() {
            showLoading(true, 'Loading filter policies...');
            
            try {
                const response = await apiCall('/api/webfilters/policies');
                if (response.success) {
                    showToast('Filter policies loaded', 'success');
                } else {
                    showToast(response.error || 'Failed to load policies', 'error');
                }
            } catch (error) {
                showToast('Failed to load filter policies', 'error');
            }
            
            showLoading(false);
        }
        
        async function analyzeStoreFiltering() {
            const brand = document.getElementById('wf-brand').value;
            const storeId = document.getElementById('wf-store').value;
            
            if (!storeId) {
                showToast('Please enter a store ID', 'warning');
                return;
            }
            
            showLoading(true, `Analyzing ${brand} store ${storeId} filtering...`);
            
            try {
                const response = await apiCall(`/api/webfilters/${brand}/${storeId}`);
                if (response.success) {
                    showToast(`Store filtering analysis completed for ${brand} store ${storeId}`, 'success');
                } else {
                    showToast(response.error || 'Analysis failed', 'error');
                }
            } catch (error) {
                showToast('Failed to analyze store filtering', 'error');
            }
            
            showLoading(false);
        }
        
        // Settings Functions
        function saveVoiceSettings() {
            const speechRate = document.getElementById('settings-speech-rate').value;
            const speechVolume = document.getElementById('settings-speech-volume').value;
            const autoAnnounce = document.getElementById('settings-auto-announce').checked;
            
            // Save to localStorage
            localStorage.setItem('voiceSettings', JSON.stringify({
                speechRate: speechRate,
                speechVolume: speechVolume,
                autoAnnounce: autoAnnounce
            }));
            
            // Apply settings if voice interface is available
            if (typeof voiceInterface !== 'undefined') {
                voiceInterface.speechRate = parseFloat(speechRate);
                voiceInterface.speechVolume = parseFloat(speechVolume);
            }
            
            showToast('Voice settings saved successfully', 'success');
        }
        
        function saveDisplaySettings() {
            const darkTheme = document.getElementById('settings-dark-theme').checked;
            const showTooltips = document.getElementById('settings-show-tooltips').checked;
            const refreshInterval = document.getElementById('settings-refresh-interval').value;
            
            // Save to localStorage
            localStorage.setItem('displaySettings', JSON.stringify({
                darkTheme: darkTheme,
                showTooltips: showTooltips,
                refreshInterval: refreshInterval
            }));
            
            showToast('Display settings saved successfully', 'success');
            
            // Apply refresh interval if changed
            if (refreshInterval > 0) {
                setInterval(refreshData, refreshInterval * 1000);
            }
        }
        
        function viewSecurityLog() {
            showToast('Security log viewer coming soon', 'info');
        }
        
        // Update range value displays
        document.addEventListener('DOMContentLoaded', function() {
            const speechRateSlider = document.getElementById('settings-speech-rate');
            const speechVolumeSlider = document.getElementById('settings-speech-volume');
            
            if (speechRateSlider) {
                speechRateSlider.addEventListener('input', function() {
                    document.getElementById('speech-rate-value').textContent = this.value + 'x';
                });
            }
            
            if (speechVolumeSlider) {
                speechVolumeSlider.addEventListener('input', function() {
                    document.getElementById('speech-volume-value').textContent = Math.round(this.value * 100) + '%';
                });
            }
        });
    </script>
</body>
</html>